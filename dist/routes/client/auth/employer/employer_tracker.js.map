{"version":3,"sources":["../../../../../routes/client/auth/employer/employer_tracker.js"],"names":["_","require","async","express","db","router","Router","exports","get","get_employer_tracker","req","res","employer_id","query","sql","values","connectAndQuery","err","results","console","error","sendStatus","length","status","send"],"mappings":"AAAA;;AAEA,IAAMA,IAAIC,QAAQ,QAAR,CAAV;AACA,IAAMC,QAAQD,QAAQ,OAAR,CAAd;AACA,IAAME,UAAUF,QAAQ,SAAR,CAAhB;AACA,IAAMG,KAAKH,QAAQ,8BAAR,CAAX;;AAEA,IAAMI,SAAS,IAAIF,QAAQG,MAAZ,EAAf;AACAC,QAAQF,MAAR,GAAiBA,MAAjB;;AAEA;;;AAGAA,OAAOG,GAAP,CAAW,qBAAX,EAAkCC,oBAAlC;;AAGA;;;;;AAKA,SAASA,oBAAT,CAA8BC,GAA9B,EAAmCC,GAAnC,EAAwC;;AAEpC,KAAMC,cAAcF,IAAIG,KAAJ,CAAUD,WAA9B;AACA,KAAME,MAAM,6ZACf,QADe,GAEf,gaAFe,GAGf,QAHe,GAIf,gaAJe,GAKf,QALe,GAMf,kaANe,GAOf,QAPe,GAQf,kaARe,GASf,QATe,GAUf,8ZAVe,GAWf,QAXe,GAYf,4ZAZG;AAaA,KAAMC,SAAS,CAACH,WAAD,EAAcA,WAAd,EAA2BA,WAA3B,EAAwCA,WAAxC,EAAqDA,WAArD,EAAkEA,WAAlE,EAA+EA,WAA/E,CAAf;AACAR,IAAGY,eAAH,CAAmB,EAACF,QAAD,EAAMC,cAAN,EAAnB,EAAkC,UAACE,GAAD,EAAMC,OAAN,EAAkB;AACvD,MAAID,GAAJ,EAAS;AACLE,WAAQC,KAAR,CAAc,gCAAd,EAAgDH,GAAhD;AACAN,OAAIU,UAAJ,CAAe,GAAf;AACH,GAHD,MAGO,IAAIH,QAAQI,MAAR,GAAiB,CAArB,EAAwB;AAC3BX,OAAIU,UAAJ,CAAe,GAAf;AACH,GAFM,MAEA;AACHV,OAAIY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBN,OAArB;AACH;AACG,EATD;AAWH","file":"employer_tracker.js","sourcesContent":["'use strict';\n\nconst _ = require('lodash');\nconst async = require('async');\nconst express = require('express');\nconst db = require('../../../../mysql_db_prod.js');\n\nconst router = new express.Router();\nexports.router = router;\n\n/**\n *  ROUTES\n */\nrouter.get('/1/employer_tracker', get_employer_tracker);\n\n\n/**\n *\n * @param req\n * @param res\n */\nfunction get_employer_tracker(req, res) {\n    \n    const employer_id = req.query.employer_id;\n    const sql = \"(SELECT * FROM yobs_tech_admin_tool_v2.job_applications LEFT JOIN yobs_tech_admin_tool_v2.employee ON  yobs_tech_admin_tool_v2.job_applications.employee_id = yobs_tech_admin_tool_v2.employee.employee_id LEFT JOIN yobs_tech_admin_tool_v2.user ON  yobs_tech_admin_tool_v2.user.user_id = yobs_tech_admin_tool_v2.employee.user_id WHERE employer_id = ? and status = 'pass' ORDER BY first_name, last_name LIMIT 5) \" +\n\t\" UNION\" +\n\t\" (SELECT * FROM yobs_tech_admin_tool_v2.job_applications LEFT JOIN yobs_tech_admin_tool_v2.employee ON  yobs_tech_admin_tool_v2.job_applications.employee_id = yobs_tech_admin_tool_v2.employee.employee_id LEFT JOIN yobs_tech_admin_tool_v2.user ON  yobs_tech_admin_tool_v2.user.user_id = yobs_tech_admin_tool_v2.employee.user_id WHERE employer_id = ? and status = 'favorited' ORDER BY first_name, last_name LIMIT 5) \" +\n\t\" UNION\" +\n\t\" (SELECT * FROM yobs_tech_admin_tool_v2.job_applications LEFT JOIN yobs_tech_admin_tool_v2.employee ON  yobs_tech_admin_tool_v2.job_applications.employee_id = yobs_tech_admin_tool_v2.employee.employee_id LEFT JOIN yobs_tech_admin_tool_v2.user ON  yobs_tech_admin_tool_v2.user.user_id = yobs_tech_admin_tool_v2.employee.user_id WHERE employer_id = ? and status = 'contacted' ORDER BY first_name, last_name LIMIT 5) \" +\n\t\" UNION\" +\n\t\" (SELECT * FROM yobs_tech_admin_tool_v2.job_applications LEFT JOIN yobs_tech_admin_tool_v2.employee ON  yobs_tech_admin_tool_v2.job_applications.employee_id = yobs_tech_admin_tool_v2.employee.employee_id LEFT JOIN yobs_tech_admin_tool_v2.user ON  yobs_tech_admin_tool_v2.user.user_id = yobs_tech_admin_tool_v2.employee.user_id WHERE employer_id = ? and status = 'interviewed' ORDER BY first_name, last_name LIMIT 5) \" +\n\t\" UNION\" +\n\t\" (SELECT * FROM yobs_tech_admin_tool_v2.job_applications LEFT JOIN yobs_tech_admin_tool_v2.employee ON  yobs_tech_admin_tool_v2.job_applications.employee_id = yobs_tech_admin_tool_v2.employee.employee_id LEFT JOIN yobs_tech_admin_tool_v2.user ON  yobs_tech_admin_tool_v2.user.user_id = yobs_tech_admin_tool_v2.employee.user_id WHERE employer_id = ? and status = 'makingoffer' ORDER BY first_name, last_name LIMIT 5) \" +\n\t\" UNION\" +\n\t\" (SELECT * FROM yobs_tech_admin_tool_v2.job_applications LEFT JOIN yobs_tech_admin_tool_v2.employee ON  yobs_tech_admin_tool_v2.job_applications.employee_id = yobs_tech_admin_tool_v2.employee.employee_id LEFT JOIN yobs_tech_admin_tool_v2.user ON  yobs_tech_admin_tool_v2.user.user_id = yobs_tech_admin_tool_v2.employee.user_id WHERE employer_id = ? and status = 'pending' ORDER BY first_name, last_name LIMIT 5) \" +\n\t\" UNION\" +\n\t\" (SELECT * FROM yobs_tech_admin_tool_v2.job_applications LEFT JOIN yobs_tech_admin_tool_v2.employee ON  yobs_tech_admin_tool_v2.job_applications.employee_id = yobs_tech_admin_tool_v2.employee.employee_id LEFT JOIN yobs_tech_admin_tool_v2.user ON  yobs_tech_admin_tool_v2.user.user_id = yobs_tech_admin_tool_v2.employee.user_id WHERE employer_id = ? and status = 'other' ORDER BY first_name, last_name LIMIT 5) \";\n    const values = [employer_id, employer_id, employer_id, employer_id, employer_id, employer_id, employer_id];\n    db.connectAndQuery({sql, values}, (err, results) => {\n\tif (err) {\n\t    console.error(\"get_employer_tracker: sql err:\", err);\n\t    res.sendStatus(500);\n\t} else if (results.length < 1) {\n\t    res.sendStatus(404);\n\t} else {\n\t    res.status(200).send(results);\n\t}\n    });\n    \n}\n\n\n"]}